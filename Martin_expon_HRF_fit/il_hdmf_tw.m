function [h,base] = il_hdmf_tw(t,V)% [h,base] = il_hdmf_tw(t,V)%% inverse logit -- creates fitted curve from parameter estimates%% t = vector of time points% V = parameters, A1 T1 d1 A2 T2 d2 A3 T3%% Rising phase:% A1 : gain (slope)% T1 : time delay% d1 : amplitude%% Falling phase% A2% T2% D2 : low point (undershoot to)% 3 logistic functions to be summed togetherbase = zeros(length(t),3);A1 = V(1);T1 = V(2);d1 = V(3);A2 = V(4);T2 = V(5);d2 = V(6);A3 = V(7);T3 = V(8);d3 = V(9);%d3 = abs(d2)-abs(d1);%h = d1*ilogit(A1*(t-T1))+d2*ilogit(A2*(t-T2))+d3*ilogit(A3*(t-T3));base(:,1)= d1*ilogit(A1*(t-T1))';base(:,2)= d2*ilogit(A2*(t-T2))';base(:,3)= d3*ilogit(A3*(t-T3))';h = sum(base,2)';return